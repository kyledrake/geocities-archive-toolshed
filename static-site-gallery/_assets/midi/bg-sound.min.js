(function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,t.BgSound=e()}})(function(){var n,e=Math.floor,t=Math.abs;return function(){function s(d,e,n){function t(o,i){if(!e[o]){if(!d[o]){var l="function"==typeof require&&require;if(!i&&l)return l(o,!0);if(r)return r(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var a=e[o]={exports:{}};d[o][0].call(a.exports,function(e){var r=d[o][1][e];return t(r||e)},a,a.exports,s,d,e,n)}return e[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)t(n[o]);return t}return s}()({1:[function(e,t,n){(function(o){function a(){let e;try{e=n.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof o&&"env"in o&&(e=o.env.DEBUG),e}n.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},n.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"===e||(r++,"%c"===e&&(o=r))}),e.splice(o,0,n)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=a,n.useColors=function(){return!!("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=e("./common")(n);const{formatters:s}=t.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,e("_process"))},{"./common":2,_process:6}],2:[function(e,n){n.exports=function(n){function r(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return o.colors[t(n)%o.colors.length]}function o(e){function t(...e){if(!t.enabled)return;const r=t,a=+new Date,s=a-(n||a);r.diff=s,r.prev=n,r.curr=a,n=a,e[0]=o.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,n)=>{if("%%"===t)return t;i++;const a=o.formatters[n];if("function"==typeof a){const n=e[i];t=a.call(r,n),e.splice(i,1),i--}return t}),o.formatArgs.call(r,e);const d=r.log||o.log;d.apply(r,e)}let n;return t.namespace=e,t.enabled=o.enabled(e),t.useColors=o.useColors(),t.color=r(e),t.destroy=a,t.extend=s,"function"==typeof o.init&&o.init(t),o.instances.push(t),t}function a(){const e=o.instances.indexOf(this);return-1!==e&&(o.instances.splice(e,1),!0)}function s(e,t){const n=o(this.namespace+("undefined"==typeof t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return o.debug=o,o.default=o,o.coerce=function(e){return e instanceof Error?e.stack||e.message:e},o.disable=function(){const e=[...o.names.map(i),...o.skips.map(i).map(e=>"-"+e)].join(",");return o.enable(""),e},o.enable=function(e){o.save(e),o.names=[],o.skips=[];let t;const n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&(e=n[t].replace(/\*/g,".*?"),"-"===e[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")));for(t=0;t<o.instances.length;t++){const e=o.instances[t];e.enabled=o.enabled(e.namespace)}},o.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=o.skips.length;t<n;t++)if(o.skips[t].test(e))return!1;for(t=0,n=o.names.length;t<n;t++)if(o.names[t].test(e))return!0;return!1},o.humanize=e("ms"),Object.keys(n).forEach(e=>{o[e]=n[e]}),o.instances=[],o.names=[],o.skips=[],o.formatters={},o.selectColor=r,o.enable(o.load()),o}},{ms:5}],3:[function(e,t){function n(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=E(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function r(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function a(e,t,n){if(t)e.call(n);else for(var r=e.length,o=f(e,r),a=0;a<r;++a)o[a].call(n)}function s(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,a=f(e,o),s=0;s<o;++s)a[s].call(n,r)}function d(e,t,n,r,o){if(t)e.call(n,r,o);else for(var a=e.length,s=f(e,a),d=0;d<a;++d)s[d].call(n,r,o)}function l(e,t,n,r,o,a){if(t)e.call(n,r,o,a);else for(var s=e.length,d=f(e,s),l=0;l<s;++l)d[l].call(n,r,o,a)}function p(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,a=f(e,o),s=0;s<o;++s)a[s].apply(n,r)}function u(e,t,n,o){var a,s,i;if("function"!=typeof n)throw new TypeError("\"listener\" argument must be a function");if(s=e._events,s?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),i=s[t]):(s=e._events=E(null),e._eventsCount=0),!i)i=s[t]=n,++e._eventsCount;else if("function"==typeof i?i=s[t]=o?[n,i]:[i,n]:o?i.unshift(n):i.push(n),!i.warned&&(a=r(e),a&&0<a&&i.length>a)){i.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+i.length+" \""+(t+"\" listeners added. Use emitter.setMaxListeners() to increase limit."));d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=i.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",d.name,d.message)}return e}function m(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e);}}function _(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=k.call(m,r);return o.listener=n,r.wrapFn=o,o}function c(e,t,n){var r=e._events;if(!r)return[];var o=r[t];return o?"function"==typeof o?n?[o.listener||o]:[o]:n?y(o):f(o,o.length):[]}function g(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function h(e,t){for(var r=t,o=r+1,a=e.length;o<a;r+=1,o+=1)e[r]=e[o];e.pop()}function f(e,t){for(var n=Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e){for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}var E=Object.create||function(e){var t=function(){};return t.prototype=e,new t},b=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},k=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0;var C,v=10;try{var F={};Object.defineProperty&&Object.defineProperty(F,"x",{value:0}),C=0===F.x}catch(e){C=!1}C?Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return v},set:function(e){if("number"!=typeof e||0>e||e!==e)throw new TypeError("\"defaultMaxListeners\" must be a positive number");v=e}}):n.defaultMaxListeners=v,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return r(this)},n.prototype.emit=function(e){var t,n,r,o,u,m,_="error"===e;if(m=this._events,m)_=_&&null==m.error;else if(!_)return!1;if(_){if(1<arguments.length&&(t=arguments[1]),t instanceof Error)throw t;else{var c=new Error("Unhandled \"error\" event. ("+t+")");throw c.context=t,c}return!1}if(n=m[e],!n)return!1;var g="function"==typeof n;switch(r=arguments.length,r){case 1:a(n,g,this);break;case 2:s(n,g,this,arguments[1]);break;case 3:d(n,g,this,arguments[1],arguments[2]);break;case 4:l(n,g,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=Array(r-1),u=1;u<r;u++)o[u-1]=arguments[u];p(n,g,this,o);}return!0},n.prototype.addListener=function(e,t){return u(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return u(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,_(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,_(this,e,t)),this},n.prototype.removeListener=function(e,t){var n,r,o,a,s;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(r=this._events,!r)return this;if(n=r[e],!n)return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=E(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,a=n.length-1;0<=a;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,o=a;break}if(0>o)return this;0===o?n.shift():h(n,o),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,s||t)}return this},n.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=E(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=E(null):delete n[e]),this;if(0===arguments.length){var o,a=b(n);for(r=0;r<a.length;++r)o=a[r],"removeListener"===o||this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=E(null),this._eventsCount=0,this}if(t=n[e],"function"==typeof t)this.removeListener(e,t);else if(t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},n.prototype.listeners=function(e){return c(this,e,!0)},n.prototype.rawListeners=function(e){return c(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},n.prototype.listenerCount=g,n.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],4:[function(e,t){function n(e,t){if(t=t||{},void 0===e)throw new Error("insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).");var n=!0===t.prepend?"prepend":"append",s=void 0===t.container?document.querySelector("head"):t.container,i=o.indexOf(s);-1===i&&(i=o.push(s)-1,a[i]={});var d;return void 0!==a[i]&&void 0!==a[i][n]?d=a[i][n]:(d=a[i][n]=r(),"prepend"==n?s.insertBefore(d,s.childNodes[0]):s.appendChild(d)),65279===e.charCodeAt(0)&&(e=e.substr(1,e.length)),d.styleSheet?d.styleSheet.cssText+=e:d.textContent+=e,d}function r(){var e=document.createElement("style");return e.setAttribute("type","text/css"),e}var o=[],a=[];t.exports=n,t.exports.insertCss=n},{}],5:[function(e,n){var i=Math.round;function r(e){if(e+="",!(100<e.length)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();return"years"===n||"year"===n||"yrs"===n||"yr"===n||"y"===n?31557600000*r:"weeks"===n||"week"===n||"w"===n?604800000*r:"days"===n||"day"===n||"d"===n?86400000*r:"hours"===n||"hour"===n||"hrs"===n||"hr"===n||"h"===n?3600000*r:"minutes"===n||"minute"===n||"mins"===n||"min"===n||"m"===n?60000*r:"seconds"===n||"second"===n||"secs"===n||"sec"===n||"s"===n?1000*r:"milliseconds"===n||"millisecond"===n||"msecs"===n||"msec"===n||"ms"===n?r:void 0}}}function o(e){var n=t(e);return 86400000<=n?i(e/86400000)+"d":3600000<=n?i(e/3600000)+"h":60000<=n?i(e/60000)+"m":1000<=n?i(e/1000)+"s":e+"ms"}function a(e){var n=t(e);return 86400000<=n?s(e,n,86400000,"day"):3600000<=n?s(e,n,3600000,"hour"):60000<=n?s(e,n,60000,"minute"):1000<=n?s(e,n,1000,"second"):e+" ms"}function s(e,t,r,n){return i(e/r)+" "+n+(t>=1.5*r?"s":"")}var l=24*(60*60000);n.exports=function(e,t){t=t||{};var n=typeof e;if("string"==n&&0<e.length)return r(e);if("number"==n&&isFinite(e))return t.long?a(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],6:[function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(n){try{return u.call(null,t,0)}catch(n){return u.call(this,t,0)}}}function a(t){if(m===clearTimeout)return clearTimeout(t);if((m===r||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(t);try{return m(t)}catch(n){try{return m.call(null,t)}catch(n){return m.call(this,t)}}}function s(){h&&c&&(h=!1,c.length?g=c.concat(g):f=-1,g.length&&d())}function d(){if(!h){var e=o(s);h=!0;for(var t=g.length;t;){for(c=g,g=[];++f<t;)c&&c[f].run();f=-1,t=g.length}c=null,h=!1,a(e)}}function l(e,t){this.fun=e,this.array=t}function p(){}var u,m,_=t.exports={};(function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{m="function"==typeof clearTimeout?clearTimeout:r}catch(t){m=r}})();var c,g=[],h=!1,f=-1;_.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new l(e,t)),1!==g.length||h||o(d)},l.prototype.run=function(){this.fun.apply(null,this.array)},_.title="browser",_.browser=!0,_.env={},_.argv=[],_.version="",_.versions={},_.on=p,_.addListener=p,_.once=p,_.off=p,_.removeListener=p,_.removeAllListeners=p,_.emit=p,_.prependListener=p,_.prependOnceListener=p,_.listeners=function(){return[]},_.binding=function(){throw new Error("process.binding is not supported")},_.cwd=function(){return"/"},_.chdir=function(){throw new Error("process.chdir is not supported")},_.umask=function(){return 0}},{}],7:[function(t,n){const r=t("debug"),o=t("events").EventEmitter,a=t("./libtimidity"),s=r("timidity"),i=r("timidity:verbose"),d=2,l=2*d,p=16384,u="undefined"!=typeof window&&(window.AudioContext||window.webkitAudioContext);class m extends o{constructor(e="/"){super(),this.destroyed=!1,e.endsWith("/")||(e+="/"),this._baseUrl=new URL(e,window.location.origin).href,this._ready=!1,this._playing=!1,this._pendingFetches={},this._songPtr=0,this._bufferPtr=0,this._array=new Int16Array(2*p),this._currentUrlOrBuf=null,this._interval=null,this._startInterval=this._startInterval.bind(this),this._stopInterval=this._stopInterval.bind(this),this._audioContext=new u,this._node=this._audioContext.createScriptProcessor(p,0,d),this._onAudioProcess=this._onAudioProcess.bind(this),this._node.addEventListener("audioprocess",this._onAudioProcess),this._node.connect(this._audioContext.destination),this._lib=a({locateFile:e=>new URL(e,this._baseUrl).href,onRuntimeInitialized:()=>this._onLibReady()})}_onLibReady(){this._lib.FS.writeFile("/timidity.cfg","\ndrumset 0\n\n 25\tDrum_000/025_Snare_Roll.pat \n 26\tDrum_000/026_Snap.pat \n 27\tDrum_000/027_High_Q.pat \n 31\tDrum_000/031_Sticks.pat \n 32\tDrum_000/032_Square_Click.pat \n 33\tDrum_000/033_Metronome_Click.pat \n 34\tDrum_000/034_Metronome_Bell.pat \n 35\tDrum_000/035_Kick_1.pat amp=100\n 36\tDrum_000/036_Kick_2.pat amp=100\n 37\tDrum_000/037_Stick_Rim.pat \n 38\tDrum_000/038_Snare_1.pat \n 39\tDrum_000/039_Clap_Hand.pat amp=100\n 40\tDrum_000/040_Snare_2.pat \n 41\tDrum_000/041_Tom_Low_2.pat amp=100\n 42\tDrum_000/042_Hi-Hat_Closed.pat \n 43\tDrum_000/043_Tom_Low_1.pat amp=100\n 44\tDrum_000/044_Hi-Hat_Pedal.pat \n 45\tDrum_000/045_Tom_Mid_2.pat amp=100\n 46\tDrum_000/046_Hi-Hat_Open.pat \n 47\tDrum_000/047_Tom_Mid_1.pat amp=100\n 48\tDrum_000/048_Tom_High_2.pat amp=100\n 49\tDrum_000/049_Cymbal_Crash_1.pat \n 50\tDrum_000/050_Tom_High_1.pat amp=100\n 51\tDrum_000/051_Cymbal_Ride_1.pat \n 52\tDrum_000/052_Cymbal_Chinese.pat \n 53\tDrum_000/053_Cymbal_Ride_Bell.pat amp=100\n 54\tDrum_000/054_Tombourine.pat \n 55\tDrum_000/055_Cymbal_Splash.pat \n 56\tDrum_000/056_Cow_Bell.pat \n 57\tDrum_000/057_Cymbal_Crash_2.pat \n 58\tDrum_000/058_Vibra-Slap.pat \n 59\tDrum_000/059_Cymbal_Ride_2.pat \n 60\tDrum_000/060_Bongo_High.pat \n 61\tDrum_000/061_Bongo_Low.pat \n 62\tDrum_000/062_Conga_High_1_Mute.pat \n 63\tDrum_000/063_Conga_High_2_Open.pat \n 64\tDrum_000/064_Conga_Low.pat \n 65\tDrum_000/065_Timbale_High.pat \n 66\tDrum_000/066_Timbale_Low.pat \n 67\tDrum_000/067_Agogo_High.pat \n 68\tDrum_000/068_Agogo_Low.pat \n 69\tDrum_000/069_Cabasa.pat amp=100\n 70\tDrum_000/070_Maracas.pat \n 71\tDrum_000/071_Whistle_1_High_Short.pat \n 72\tDrum_000/072_Whistle_2_Low_Long.pat \n 73\tDrum_000/073_Guiro_1_Short.pat \n 74\tDrum_000/074_Guiro_2_Long.pat \n 75\tDrum_000/075_Claves.pat amp=100\n 76\tDrum_000/076_Wood_Block_1_High.pat \n 77\tDrum_000/077_Wood_Block_2_Low.pat \n 78\tDrum_000/078_Cuica_1_Mute.pat amp=100\n 79\tDrum_000/079_Cuica_2_Open.pat amp=100\n 80\tDrum_000/080_Triangle_1_Mute.pat \n 81\tDrum_000/081_Triangle_2_Open.pat \n 82\tDrum_000/082_Shaker.pat \n 84\tDrum_000/084_Belltree.pat \n\nbank 0\n\n 0\tTone_000/000_Acoustic_Grand_Piano.pat amp=120 pan=center\n 1\tTone_000/001_Acoustic_Brite_Piano.pat \n 2\tTone_000/002_Electric_Grand_Piano.pat \n 4\tTone_000/004_Electric_Piano_1_Rhodes.pat \n 5\tTone_000/005_Electric_Piano_2_Chorused_Yamaha_DX.pat \n 6\tTone_000/006_Harpsichord.pat \n 7\tTone_000/007_Clavinet.pat \n 8\tTone_000/008_Celesta.pat \n 9\tTone_000/009_Glockenspiel.pat \n 13\tTone_000/013_Xylophone.pat \n 14\tTone_000/014_Tubular_Bells.pat \n 15\tTone_000/015_Dulcimer.pat \n 16\tTone_000/016_Hammond_Organ.pat \n 19\tTone_000/019_Church_Organ.pat \n 21\tTone_000/021_Accordion.pat \n 23\tTone_000/023_Tango_Accordion.pat \n 24\tTone_000/024_Nylon_Guitar.pat \n 25\tTone_000/025_Steel_Guitar.pat \n 26\tTone_000/026_Jazz_Guitar.pat \n 27\tTone_000/027_Clean_Electric_Guitar.pat \n 28\tTone_000/028_Muted_Electric_Guitar.pat \n 29\tTone_000/029_Overdriven_Guitar.pat \n 30\tTone_000/030_Distortion_Guitar.pat \n 32\tTone_000/032_Acoustic_Bass.pat \n 33\tTone_000/033_Finger_Bass.pat \n 34\tTone_000/034_Pick_Bass.pat \n 35\tTone_000/035_Fretless_Bass.pat \n 36\tTone_000/036_Slap_Bass_1.pat \n 37\tTone_000/037_Slap_Bass_2.pat \n 38\tTone_000/038_Synth_Bass_1.pat \n 40\tTone_000/040_Violin.pat \n 42\tTone_000/042_Cello.pat \n 44\tTone_000/044_Tremolo_Strings.pat \n 45\tTone_000/045_Pizzicato_Strings.pat \n 46\tTone_000/046_Harp.pat \n 47\tTone_000/047_Timpani.pat \n 48\tTone_000/048_String_Ensemble_1_Marcato.pat \n 53\tTone_000/053_Voice_Oohs.pat \n 56\tTone_000/056_Trumpet.pat \n 57\tTone_000/057_Trombone.pat \n 58\tTone_000/058_Tuba.pat \n 59\tTone_000/059_Muted_Trumpet.pat \n 60\tTone_000/060_French_Horn.pat \n 61\tTone_000/061_Brass_Section.pat \n 64\tTone_000/064_Soprano_Sax.pat \n 65\tTone_000/065_Alto_Sax.pat \n 66\tTone_000/066_Tenor_Sax.pat \n 67\tTone_000/067_Baritone_Sax.pat \n 68\tTone_000/068_Oboe.pat \n 69\tTone_000/069_English_Horn.pat \n 70\tTone_000/070_Bassoon.pat \n 71\tTone_000/071_Clarinet.pat \n 72\tTone_000/072_Piccolo.pat \n 73\tTone_000/073_Flute.pat \n 74\tTone_000/074_Recorder.pat \n 75\tTone_000/075_Pan_Flute.pat \n 76\tTone_000/076_Bottle_Blow.pat \n 79\tTone_000/079_Ocarina.pat \n 80\tTone_000/080_Square_Wave.pat \n 84\tTone_000/084_Charang.pat \n 88\tTone_000/088_New_Age.pat \n 94\tTone_000/094_Halo_Pad.pat \n 95\tTone_000/095_Sweep_Pad.pat \n 98\tTone_000/098_Crystal.pat \n 101\tTone_000/101_Goblins--Unicorn.pat \n 102\tTone_000/102_Echo_Voice.pat \n 104\tTone_000/104_Sitar.pat \n 114\tTone_000/114_Steel_Drums.pat \n 115\tTone_000/115_Wood_Block.pat \n 120\tTone_000/120_Guitar_Fret_Noise.pat \n 122\tTone_000/122_Seashore.pat \n 125\tTone_000/125_Helicopter.pat \n\n");const e=this._lib._mid_init("/timidity.cfg");return 0===e?void(this._bufferPtr=this._lib._malloc(p*l),i("Initialized libtimidity"),this._ready=!0,this.emit("_ready")):this._destroy(new Error("Failed to initialize libtimidity"))}async load(e){if(s("load %o",e),this.destroyed)throw new Error("load() called after destroy()");if(this._audioContext.resume(),this._songPtr&&this._destroySong(),this.emit("unstarted"),this._stopInterval(),!this._ready)return this.once("_ready",()=>this.load(e));this.emit("buffering"),this._currentUrlOrBuf=e;let t;if("string"==typeof e){if(t=await this._fetch(new URL(e,this._baseUrl)),this._currentUrlOrBuf!==e)return;}else if(e instanceof Uint8Array)t=e;else throw new Error("load() expects a `string` or `Uint8Array` argument");let n=this._loadSong(t),r=this._lib._mid_get_load_request_count(n);if(0<r){let o=this._getMissingInstruments(n,r);if(i("Fetching instruments: %o",o),await Promise.all(o.map(e=>this._fetchInstrument(e))),this._currentUrlOrBuf!==e)return;this._lib._mid_song_free(n),n=this._loadSong(t),r=this._lib._mid_get_load_request_count(n),0<r&&(o=this._getMissingInstruments(n,r),s("Playing with missing instruments: %o",o))}this._songPtr=n,this._lib._mid_song_start(this._songPtr),i("Song and instruments are loaded")}_getMissingInstruments(e,t){const n=[];for(let r=0;r<t;r++){const t=this._lib._mid_get_load_request(e,r),o=this._lib.UTF8ToString(t);n.push(o)}return n}_loadSong(e){const t=this._lib._mid_alloc_options(44100,32784,d,p),n=this._lib._malloc(e.byteLength);this._lib.HEAPU8.set(e,n);const r=this._lib._mid_istream_open_mem(n,e.byteLength),o=this._lib._mid_song_load(r,t);return this._lib._mid_istream_close(r),this._lib._free(t),this._lib._free(n),0===o?this._destroy(new Error("Failed to load MIDI file")):o}async _fetchInstrument(e){if(this._pendingFetches[e])return this._pendingFetches[e];const t=new URL(e,this._baseUrl),n=this._fetch(t);this._pendingFetches[e]=n;const r=await n;return this._writeInstrumentFile(e,r),delete this._pendingFetches[e],r}_writeInstrumentFile(e,t){const n=e.split("/").slice(0,-1).join("/");this._mkdirp(n),this._lib.FS.writeFile(e,t,{encoding:"binary"})}_mkdirp(e){const t=e.split("/");let n="/";for(let r=0;r<t.length;r++){const e=t[r];try{this._lib.FS.mkdir(`${n}${e}`)}catch(e){}n+=`${e}/`}}async _fetch(e){const t=await window.fetch(e,{mode:"cors",credentials:"same-origin"});if(200!==t.status)throw new Error(`Could not load ${e}`);const n=await t.arrayBuffer(),r=new Uint8Array(n);return r}play(){if(s("play"),this.destroyed)throw new Error("play() called after destroy()");this._audioContext.resume(),this._playing=!0,this._ready&&!this._currentUrlOrBuf&&(this.emit("playing"),this._startInterval())}_onAudioProcess(e){const t=this._songPtr&&this._playing?this._readMidiData():0;0<t&&this._currentUrlOrBuf&&(this._currentUrlOrBuf=null,this.emit("playing"),this._startInterval());const n=e.outputBuffer.getChannelData(0),r=e.outputBuffer.getChannelData(1);for(let o=0;o<t;o++)n[o]=this._array[2*o]/32767,r[o]=this._array[2*o+1]/32767;for(let o=t;o<p;o++)n[o]=0,r[o]=0;this._songPtr&&this._playing&&0===t&&(this.emit("ended"),!this.destroyed&&(this.seek(0),this.pause()))}_readMidiData(){const e=this._lib._mid_song_read_wave(this._songPtr,this._bufferPtr,p*l),t=e/l;return 0===t?0:(this._array.set(this._lib.HEAP16.subarray(this._bufferPtr/2,(this._bufferPtr+e)/2)),t)}pause(){if(s("pause"),this.destroyed)throw new Error("pause() called after destroy()");this._playing=!1,this._stopInterval(),this.emit("paused")}seek(t){if(s("seek %d",t),this.destroyed)throw new Error("seek() called after destroy()");if(this._songPtr){const n=e(1e3*t);this._lib._mid_song_seek(this._songPtr,n),this._onTimeupdate()}}get currentTime(){return this.destroyed||!this._songPtr?0:this._lib._mid_song_get_time(this._songPtr)/1e3}get duration(){return this.destroyed||!this._songPtr?1:this._lib._mid_song_get_total_time(this._songPtr)/1e3}_onTimeupdate(){this.emit("timeupdate",this.currentTime)}_startInterval(){this._onTimeupdate(),this._interval=setInterval(()=>this._onTimeupdate(),1e3)}_stopInterval(){this._onTimeupdate(),clearInterval(this._interval),this._interval=null}destroy(){if(s("destroy"),this.destroyed)throw new Error("destroy() called after destroy()");this._destroy()}_destroy(e){this.destroyed||(this.destroyed=!0,this._stopInterval(),this._array=null,this._songPtr&&this._destroySong(),this._bufferPtr&&(this._lib._free(this._bufferPtr),this._bufferPtr=0),this._node&&(this._node.disconnect(),this._node.removeEventListener("audioprocess",this._onAudioProcess)),this._audioContext&&this._audioContext.close(),e&&this.emit("error",e),s("destroyed (err %o)",e))}_destroySong(){this._lib._mid_song_free(this._songPtr),this._songPtr=0}}n.exports=m},{"./libtimidity":8,debug:1,events:3}],8:[function(r,o,a){var s=function(){var n="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return function(r){var H=Math.ceil,U=Math.min,W=Math.max;function o(e){return G.locateFile?G.locateFile(e,X):X+e}function a(e,t,n){for(var r=String.fromCharCode,o=t+n,a=t;e[a]&&!(a>=o);)++a;if(16<a-t&&e.subarray&&ue)return ue.decode(e.subarray(t,a));for(var s,i="";t<a;){if(s=e[t++],!(128&s)){i+=r(s);continue}var d=63&e[t++];if(192==(224&s)){i+=r((31&s)<<6|d);continue}var l=63&e[t++];if(s=224==(240&s)?(15&s)<<12|d<<6|l:(7&s)<<18|d<<12|l<<6|63&e[t++],65536>s)i+=r(s);else{var p=s-65536;i+=r(55296|p>>10,56320|1023&p)}}return i}function s(e,t){return e?a(ne,e,t):""}function i(e,t,n,r){if(!(0<r))return 0;for(var o,a=n,s=n+r-1,d=0;d<e.length;++d){if(o=e.charCodeAt(d),55296<=o&&57343>=o){var l=e.charCodeAt(++d);o=65536+((1023&o)<<10)|1023&l}if(127>=o){if(n>=s)break;t[n++]=o}else if(2047>=o){if(n+1>=s)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(65535>=o){if(n+2>=s)break;t[n++]=224|o>>12,t[n++]=128|63&o>>6,t[n++]=128|63&o}else{if(n+3>=s)break;t[n++]=240|o>>18,t[n++]=128|63&o>>12,t[n++]=128|63&o>>6,t[n++]=128|63&o}}return t[n]=0,n-a}function d(e,t,n){return i(e,ne,t,n)}function l(e){for(var t,n=0,r=0;r<e.length;++r)t=e.charCodeAt(r),55296<=t&&57343>=t&&(t=65536+((1023&t)<<10)|1023&e.charCodeAt(++r)),127>=t?++n:2047>=t?n+=2:65535>=t?n+=3:n+=4;return n}function p(e){return e}function u(e){var t=/__Z[\w\d_]+/g;return e.replace(t,function(e){var t=p(e);return e===t?e:t+" ["+e+"]"})}function m(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(n){t=n}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function _(){var e=m();return G.extraStackTrace&&(e+="\n"+G.extraStackTrace()),u(e)}function c(e,t){return 0<e%t&&(e+=t-e%t),e}function g(){G.HEAP8=te=new Int8Array(ee),G.HEAP16=re=new Int16Array(ee),G.HEAP32=ae=new Int32Array(ee),G.HEAPU8=ne=new Uint8Array(ee),G.HEAPU16=oe=new Uint16Array(ee),G.HEAPU32=se=new Uint32Array(ee),G.HEAPF32=ie=new Float32Array(ee),G.HEAPF64=de=new Float64Array(ee)}function h(e){for(;0<e.length;){var t=e.shift();if("function"==typeof t){t();continue}var n=t.func;"number"==typeof n?void 0===t.arg?G.dynCall_v(n):G.dynCall_vi(n,t.arg):n(void 0===t.arg?null:t.arg)}}function f(){if(G.preRun)for("function"==typeof G.preRun&&(G.preRun=[G.preRun]);G.preRun.length;)k(G.preRun.shift());h(he)}function y(){be=!0,G.noFSInit||Be.init.initialized||Be.init(),Ae.init(),h(fe)}function E(){Be.ignorePermissions=!1,h(ye)}function b(){if(G.postRun)for("function"==typeof G.postRun&&(G.postRun=[G.postRun]);G.postRun.length;)C(G.postRun.shift());h(Ee)}function k(e){he.unshift(e)}function C(e){Ee.unshift(e)}function v(e){return e}function F(){De++,G.monitorRunDependencies&&G.monitorRunDependencies(De)}function D(){if(De--,G.monitorRunDependencies&&G.monitorRunDependencies(De),0==De&&(null!==we&&(clearInterval(we),we=null),Se)){var e=Se;Se=null,e()}}function w(e){var t=String.prototype;return t.startsWith?e.startsWith("data:application/octet-stream;base64,"):0===e.indexOf("data:application/octet-stream;base64,")}function S(){try{if(G.wasmBinary)return new Uint8Array(G.wasmBinary);if(G.readBinary)return G.readBinary(Te);throw"both async and sync fetching of the wasm failed"}catch(e){j(e)}}function T(){return G.wasmBinary||0||"function"!=typeof fetch?new Promise(function(e){e(S())}):fetch(Te,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Te+"'";return e.arrayBuffer()}).catch(function(){return S()})}function P(e){function t(e){var t=e.exports;G.asm=t,D("wasm-instantiate")}function n(e){t(e.instance)}function r(e){return T().then(function(e){return WebAssembly.instantiate(e,a)}).then(e,function(e){$("failed to asynchronously prepare wasm: "+e),j(e)})}function o(){return G.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||w(Te)||"function"!=typeof fetch?r(n):void fetch(Te,{credentials:"same-origin"}).then(function(e){return WebAssembly.instantiateStreaming(e,a).then(n,function(e){$("wasm streaming compile failed: "+e),$("falling back to ArrayBuffer instantiation"),r(n)})})}var a={env:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:J};if(F("wasm-instantiate"),G.instantiateWasm)try{return G.instantiateWasm(a,t)}catch(t){return $("Module.instantiateWasm callback failed with error: "+t),!1}return o(),{}}function x(e){return G.___errno_location&&(ae[G.___errno_location()>>2]=e),e}function A(e,t){Re.varargs=t;try{var n=Re.getStreamFromFD(),r=Re.get(),o=Re.get(),a=Re.get(),s=Re.get(),i=r*4294967296+(o>>>0),d=9007199254740992;return i<=-d||i>=d?-75:(Be.llseek(n,i,s),tempI64=[n.position>>>0,(tempDouble=n.position,1<=+ke(tempDouble)?0<tempDouble?(0|Fe(+ve(tempDouble/4294967296),4294967295))>>>0:~~+Ce((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],ae[a>>2]=tempI64[0],ae[a+4>>2]=tempI64[1],n.getdents&&0===i&&0===s&&(n.getdents=null),0)}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}}function L(e,t){Re.varargs=t;try{var n=Re.getStreamFromFD(),r=Re.get();switch(r){case 0:{var o=Re.get();if(0>o)return-22;var a;return a=Be.open(n.path,n.flags,0,o),a.fd}case 1:case 2:return 0;case 3:return n.flags;case 4:{var o=Re.get();return n.flags|=o,0}case 12:{var o=Re.get();return re[o+0>>1]=2,0}case 13:case 14:return 0;case 16:case 8:return-22;case 9:return x(22),-1;default:return-22;}}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}}function B(e,t){Re.varargs=t;try{var n=Re.getStreamFromFD(),r=Re.get();switch(r){case 21509:case 21505:return n.tty?0:-25;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-25;case 21519:{if(!n.tty)return-25;var o=Re.get();return ae[o>>2]=0,0}case 21520:return n.tty?-22:-25;case 21531:{var o=Re.get();return Be.ioctl(n,r,o)}case 21523:return n.tty?0:-25;case 21524:return n.tty?0:-25;default:j("bad ioctl syscall "+r);}}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}}function R(){return te.length}function M(e,t,n){ne.set(ne.subarray(t,t+n),e)}function O(e){e=c(e,65536);var t=ee.byteLength;try{var n=Z.grow((e-t)/65536);return-1!==n&&(ee=Z.buffer,!0)}catch(t){return!1}}function N(e,t,n){var r=0<n?n:l(e)+1,o=Array(r),a=i(e,o,0,o.length);return t&&(o.length=a),o}function z(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function I(e){function t(){G.calledRun||(G.calledRun=!0,le||(y(),E(),G.onRuntimeInitialized&&G.onRuntimeInitialized(),b()))}(e=e||G.arguments,!(0<De))&&(f(),0<De||G.calledRun||(G.setStatus?(G.setStatus("Running..."),setTimeout(function(){setTimeout(function(){G.setStatus("")},1),t()},1)):t()))}function j(e){throw G.onAbort&&G.onAbort(e),void 0===e?e="":(Y(e),$(e),e="\""+e+"\""),le=!0,pe=1,"abort("+e+"). Build with -s ASSERTIONS=1 for more info."}r=r||{};var q,G="undefined"==typeof r?{}:r,K={};for(q in G)G.hasOwnProperty(q)&&(K[q]=G[q]);G.arguments=[],G.thisProgram="./this.program",G.quit=function(e,t){throw t},G.preRun=[],G.postRun=[];var V=!1,X="";document.currentScript&&(X=document.currentScript.src),n&&(X=n),X=0===X.indexOf("blob:")?"":X.substr(0,X.lastIndexOf("/")+1),G.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},V&&(G.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),G.readAsync=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){return 200==r.status||0==r.status&&r.response?void t(r.response):void n()},r.onerror=n,r.send(null)},G.setWindowTitle=function(e){document.title=e};var Y=G.print||("undefined"==typeof console?"undefined"==typeof print?null:print:console.log.bind(console)),$=G.printErr||("undefined"==typeof printErr?"undefined"!=typeof console&&console.warn.bind(console)||Y:printErr);for(q in K)K.hasOwnProperty(q)&&(G[q]=K[q]);K=void 0;var J={"f64-rem":function(e,t){return e%t},debugger:function(){debugger}};"object"!=typeof WebAssembly&&$("no native wasm support detected");var Z,Q,ee,te,ne,re,oe,ae,se,ie,de,le=!1,pe=0,ue="undefined"==typeof TextDecoder?void 0:new TextDecoder("utf8"),me="undefined"==typeof TextDecoder?void 0:new TextDecoder("utf-16le"),_e=10848,ce=5242880,ge=G.TOTAL_MEMORY||16777216;ge<ce&&$("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+ge+"! (TOTAL_STACK="+ce+")"),G.buffer?ee=G.buffer:"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(Z=new WebAssembly.Memory({initial:ge/65536}),ee=Z.buffer):ee=new ArrayBuffer(ge),g(),ae[_e>>2]=5253760;var he=[],fe=[],ye=[],Ee=[],be=!1,ke=t,Ce=H,ve=e,Fe=U,De=0,we=null,Se=null;G.preloadedImages={},G.preloadedAudios={};var Te="libtimidity.wasm";w(Te)||(Te=o(Te)),G.asm=function(e,t){t.memory=Z,t.table=Q=new WebAssembly.Table({initial:24,maximum:24,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0;var n=P(t);return n};var Pe={splitPath:function(e){var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return t.exec(e).slice(1)},normalizeArray:function(e,t){for(var n,r=0,o=e.length-1;0<=o;o--)n=e[o],"."===n?e.splice(o,1):".."===n?(e.splice(o,1),r++):r&&(e.splice(o,1),r--);if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),n="/"===e.substr(-1);return e=Pe.normalizeArray(e.split("/").filter(function(e){return!!e}),!t).join("/"),e||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=Pe.splitPath(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},basename:function(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return Pe.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return Pe.normalize(e.join("/"))},join2:function(e,t){return Pe.normalize(e+"/"+t)}},xe={resolve:function(){for(var e,t="",n=!1,r=arguments.length-1;-1<=r&&!n;r--){if(e=0<=r?arguments[r]:Be.cwd(),"string"!=typeof e)throw new TypeError("Arguments to path.resolve must be strings");else if(!e)return"";t=e+"/"+t,n="/"===e.charAt(0)}return t=Pe.normalizeArray(t.split("/").filter(function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},relative:function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=xe.resolve(e).substr(1),t=xe.resolve(t).substr(1);for(var r=n(e.split("/")),o=n(t.split("/")),a=U(r.length,o.length),s=a,d=0;d<a;d++)if(r[d]!==o[d]){s=d;break}for(var l=[],d=s;d<r.length;d++)l.push("..");return l=l.concat(o.slice(s)),l.join("/")}},Ae={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Ae.ttys[e]={input:[],output:[],ops:t},Be.registerDevice(e,Ae.stream_ops)},stream_ops:{open:function(e){var t=Ae.ttys[e.node.rdev];if(!t)throw new Be.ErrnoError(19);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,n,r){if(!e.tty||!e.tty.ops.get_char)throw new Be.ErrnoError(6);for(var o=0,a=0;a<r;a++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(t){throw new Be.ErrnoError(5)}if(void 0===s&&0===o)throw new Be.ErrnoError(11);if(null===s||void 0===s)break;o++,t[n+a]=s}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,n,r){if(!e.tty||!e.tty.ops.put_char)throw new Be.ErrnoError(6);try{for(var o=0;o<r;o++)e.tty.ops.put_char(e.tty,t[n+o])}catch(t){throw new Be.ErrnoError(5)}return r&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?(t=window.prompt("Input: "),null!==t&&(t+="\n")):"function"==typeof readline&&(t=readline(),null!==t&&(t+="\n")),!t)return null;e.input=N(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(Y(a(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&(Y(a(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?($(a(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&0<e.output.length&&($(a(e.output,0)),e.output=[])}}},Le={ops_table:null,mount:function(){return Le.createNode(null,"/",16895,0)},createNode:function(e,t,n,r){if(Be.isBlkdev(n)||Be.isFIFO(n))throw new Be.ErrnoError(1);Le.ops_table||(Le.ops_table={dir:{node:{getattr:Le.node_ops.getattr,setattr:Le.node_ops.setattr,lookup:Le.node_ops.lookup,mknod:Le.node_ops.mknod,rename:Le.node_ops.rename,unlink:Le.node_ops.unlink,rmdir:Le.node_ops.rmdir,readdir:Le.node_ops.readdir,symlink:Le.node_ops.symlink},stream:{llseek:Le.stream_ops.llseek}},file:{node:{getattr:Le.node_ops.getattr,setattr:Le.node_ops.setattr},stream:{llseek:Le.stream_ops.llseek,read:Le.stream_ops.read,write:Le.stream_ops.write,allocate:Le.stream_ops.allocate,mmap:Le.stream_ops.mmap,msync:Le.stream_ops.msync}},link:{node:{getattr:Le.node_ops.getattr,setattr:Le.node_ops.setattr,readlink:Le.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Le.node_ops.getattr,setattr:Le.node_ops.setattr},stream:Be.chrdev_stream_ops}});var o=Be.createNode(e,t,n,r);return Be.isDir(o.mode)?(o.node_ops=Le.ops_table.dir.node,o.stream_ops=Le.ops_table.dir.stream,o.contents={}):Be.isFile(o.mode)?(o.node_ops=Le.ops_table.file.node,o.stream_ops=Le.ops_table.file.stream,o.usedBytes=0,o.contents=null):Be.isLink(o.mode)?(o.node_ops=Le.ops_table.link.node,o.stream_ops=Le.ops_table.link.stream):Be.isChrdev(o.mode)&&(o.node_ops=Le.ops_table.chrdev.node,o.stream_ops=Le.ops_table.chrdev.stream),o.timestamp=Date.now(),e&&(e.contents[t]=o),o},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],n=0;n<e.usedBytes;++n)t.push(e.contents[n]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array},expandFileStorage:function(e,t){var n=e.contents?e.contents.length:0;if(!(n>=t)){t=W(t,0|n*(1048576>n?2:1.125)),0!=n&&(t=W(t,256));var r=e.contents;return e.contents=new Uint8Array(t),void(0<e.usedBytes&&e.contents.set(r.subarray(0,e.usedBytes),0))}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var n=e.contents;return e.contents=new Uint8Array(new ArrayBuffer(t)),n&&e.contents.set(n.subarray(0,U(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=Be.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,t.size=Be.isDir(e.mode)?4096:Be.isFile(e.mode)?e.usedBytes:Be.isLink(e.mode)?e.link.length:0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=H(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Le.resizeFileStorage(e,t.size)},lookup:function(){throw Be.genericErrors[2]},mknod:function(e,t,n,r){return Le.createNode(e,t,n,r)},rename:function(e,t,n){if(Be.isDir(e.mode)){var r;try{r=Be.lookupNode(t,n)}catch(t){}if(r)for(var o in r.contents)throw new Be.ErrnoError(39)}delete e.parent.contents[e.name],e.name=n,t.contents[n]=e,e.parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var n=Be.lookupNode(e,t);for(var r in n.contents)throw new Be.ErrnoError(39);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var n in e.contents)e.contents.hasOwnProperty(n)&&t.push(n);return t},symlink:function(e,t,n){var r=Le.createNode(e,t,41471,0);return r.link=n,r},readlink:function(e){if(!Be.isLink(e.mode))throw new Be.ErrnoError(22);return e.link}},stream_ops:{read:function(e,t,n,r,o){var a=e.node.contents;if(o>=e.node.usedBytes)return 0;var s=U(e.node.usedBytes-o,r);if(8<s&&a.subarray)t.set(a.subarray(o,o+s),n);else for(var d=0;d<s;d++)t[n+d]=a[o+d];return s},write:function(e,t,n,r,o,a){if(a=!1,!r)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(a)return s.contents=t.subarray(n,n+r),s.usedBytes=r,r;if(0===s.usedBytes&&0===o)return s.contents=new Uint8Array(t.subarray(n,n+r)),s.usedBytes=r,r;if(o+r<=s.usedBytes)return s.contents.set(t.subarray(n,n+r),o),r}if(Le.expandFileStorage(s,o+r),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(n,n+r),o);else for(var d=0;d<r;d++)s.contents[o+d]=t[n+d];return s.usedBytes=W(s.usedBytes,o+r),r},llseek:function(e,t,n){var r=t;if(1===n?r+=e.position:2==n&&Be.isFile(e.node.mode)&&(r+=e.node.usedBytes),0>r)throw new Be.ErrnoError(22);return r},allocate:function(e,t,n){Le.expandFileStorage(e.node,t+n),e.node.usedBytes=W(e.node.usedBytes,t+n)},mmap:function(e,t,n,r,o,a,s){if(!Be.isFile(e.node.mode))throw new Be.ErrnoError(19);var i,d,l=e.node.contents;if(!(2&s)&&(l.buffer===t||l.buffer===t.buffer))d=!1,i=l.byteOffset;else{if((0<o||o+r<e.node.usedBytes)&&(l.subarray?l=l.subarray(o,o+r):l=Array.prototype.slice.call(l,o,o+r)),d=!0,i=ze(r),!i)throw new Be.ErrnoError(12);t.set(l,i)}return{ptr:i,allocated:d}},msync:function(e,t,n,r,o){if(!Be.isFile(e.node.mode))throw new Be.ErrnoError(19);if(2&o)return 0;Le.stream_ops.write(e,t,0,r,n,!1);return 0}}},Be={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(t){if(!(t instanceof Be.ErrnoError))throw t+" : "+_();return x(t.errno)},lookupPath:function(e,t){if(e=xe.resolve(Be.cwd(),e),t=t||{},!e)return{path:"",node:null};var n={follow_mount:!0,recurse_count:0};for(var r in n)void 0===t[r]&&(t[r]=n[r]);if(8<t.recurse_count)throw new Be.ErrnoError(40);for(var o,a=Pe.normalizeArray(e.split("/").filter(function(e){return!!e}),!1),s=Be.root,d="/",l=0;l<a.length&&(o=l==a.length-1,!(o&&t.parent));l++)if(s=Be.lookupNode(s,a[l]),d=Pe.join2(d,a[l]),Be.isMountpoint(s)&&(!o||o&&t.follow_mount)&&(s=s.mounted.root),!o||t.follow)for(var p,u=0;Be.isLink(s.mode);){p=Be.readlink(d),d=xe.resolve(Pe.dirname(d),p);var m=Be.lookupPath(d,{recurse_count:t.recurse_count});if(s=m.node,40<u++)throw new Be.ErrnoError(40)}return{path:d,node:s}},getPath:function(e){for(var t;;){if(Be.isRoot(e)){var n=e.mount.mountpoint;return t?"/"===n[n.length-1]?n+t:n+"/"+t:n}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var n=0,r=0;r<t.length;r++)n=0|(n<<5)-n+t.charCodeAt(r);return(e+n>>>0)%Be.nameTable.length},hashAddNode:function(e){var t=Be.hashName(e.parent.id,e.name);e.name_next=Be.nameTable[t],Be.nameTable[t]=e},hashRemoveNode:function(e){var t=Be.hashName(e.parent.id,e.name);if(Be.nameTable[t]===e)Be.nameTable[t]=e.name_next;else for(var n=Be.nameTable[t];n;){if(n.name_next===e){n.name_next=e.name_next;break}n=n.name_next}},lookupNode:function(e,t){var n=Be.mayLookup(e);if(n)throw new Be.ErrnoError(n,e);for(var r,o=Be.hashName(e.id,t),a=Be.nameTable[o];a;a=a.name_next)if(r=a.name,a.parent.id===e.id&&r===t)return a;return Be.lookup(e,t)},createNode:function(e,t,n,r){if(!Be.FSNode){Be.FSNode=function(e,t,n,r){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Be.nextInode++,this.name=t,this.mode=n,this.node_ops={},this.stream_ops={},this.rdev=r},Be.FSNode.prototype={};var o=146;Object.defineProperties(Be.FSNode.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&o)===o},set:function(e){e?this.mode|=o:this.mode&=~o}},isFolder:{get:function(){return Be.isDir(this.mode)}},isDevice:{get:function(){return Be.isChrdev(this.mode)}}})}var a=new Be.FSNode(e,t,n,r);return Be.hashAddNode(a),a},destroyNode:function(e){Be.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=Be.flagModes[e];if("undefined"==typeof t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return Be.ignorePermissions?0:-1===t.indexOf("r")||292&e.mode?-1===t.indexOf("w")||146&e.mode?-1===t.indexOf("x")||73&e.mode?0:13:13:13},mayLookup:function(e){var t=Be.nodePermissions(e,"x");return t?t:e.node_ops.lookup?0:13},mayCreate:function(e,t){try{Be.lookupNode(e,t);return 17}catch(t){}return Be.nodePermissions(e,"wx")},mayDelete:function(e,t,n){var r;try{r=Be.lookupNode(e,t)}catch(t){return t.errno}var o=Be.nodePermissions(e,"wx");if(o)return o;if(n){if(!Be.isDir(r.mode))return 20;if(Be.isRoot(r)||Be.getPath(r)===Be.cwd())return 16}else if(Be.isDir(r.mode))return 21;return 0},mayOpen:function(e,t){return e?Be.isLink(e.mode)?40:Be.isDir(e.mode)&&("r"!==Be.flagsToPermissionString(t)||512&t)?21:Be.nodePermissions(e,Be.flagsToPermissionString(t)):2},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||Be.MAX_OPEN_FDS;for(var n=e;n<=t;n++)if(!Be.streams[n])return n;throw new Be.ErrnoError(24)},getStream:function(e){return Be.streams[e]},createStream:function(e,t,n){Be.FSStream||(Be.FSStream=function(){},Be.FSStream.prototype={},Object.defineProperties(Be.FSStream.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}}));var r=new Be.FSStream;for(var o in e)r[o]=e[o];e=r;var a=Be.nextfd(t,n);return e.fd=a,Be.streams[a]=e,e},closeStream:function(e){Be.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=Be.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new Be.ErrnoError(29)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){Be.devices[e]={stream_ops:t}},getDevice:function(e){return Be.devices[e]},getMounts:function(e){for(var t,n=[],r=[e];r.length;)t=r.pop(),n.push(t),r.push.apply(r,t.mounts);return n},syncfs:function(e,t){function n(e){return Be.syncFSRequests--,t(e)}function r(e){return e?r.errored?void 0:(r.errored=!0,n(e)):void(++a>=o.length&&n(null))}"function"==typeof e&&(t=e,e=!1),Be.syncFSRequests++,1<Be.syncFSRequests&&console.log("warning: "+Be.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var o=Be.getMounts(Be.root.mount),a=0;o.forEach(function(t){return t.type.syncfs?void t.type.syncfs(t,e,r):r(null)})},mount:function(e,t,n){var r,o="/"===n,a=!n;if(o&&Be.root)throw new Be.ErrnoError(16);else if(!o&&!a){var s=Be.lookupPath(n,{follow_mount:!1});if(n=s.path,r=s.node,Be.isMountpoint(r))throw new Be.ErrnoError(16);if(!Be.isDir(r.mode))throw new Be.ErrnoError(20)}var i={type:e,opts:t,mountpoint:n,mounts:[]},d=e.mount(i);return d.mount=i,i.root=d,o?Be.root=d:r&&(r.mounted=i,r.mount&&r.mount.mounts.push(i)),d},unmount:function(e){var t=Be.lookupPath(e,{follow_mount:!1});if(!Be.isMountpoint(t.node))throw new Be.ErrnoError(22);var n=t.node,r=n.mounted,o=Be.getMounts(r);Object.keys(Be.nameTable).forEach(function(e){for(var t,n=Be.nameTable[e];n;)t=n.name_next,-1!==o.indexOf(n.mount)&&Be.destroyNode(n),n=t}),n.mounted=null;var a=n.mount.mounts.indexOf(r);n.mount.mounts.splice(a,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,n){var r=Be.lookupPath(e,{parent:!0}),o=r.node,a=Pe.basename(e);if(!a||"."===a||".."===a)throw new Be.ErrnoError(22);var s=Be.mayCreate(o,a);if(s)throw new Be.ErrnoError(s);if(!o.node_ops.mknod)throw new Be.ErrnoError(1);return o.node_ops.mknod(o,a,t,n)},create:function(e,t){return t=void 0===t?438:t,t&=4095,t|=32768,Be.mknod(e,t,0)},mkdir:function(e,t){return t=void 0===t?511:t,t&=1023,t|=16384,Be.mknod(e,t,0)},mkdirTree:function(e,t){for(var n=e.split("/"),r="",o=0;o<n.length;++o)if(n[o]){r+="/"+n[o];try{Be.mkdir(r,t)}catch(t){if(17!=t.errno)throw t}}},mkdev:function(e,t,n){return"undefined"==typeof n&&(n=t,t=438),t|=8192,Be.mknod(e,t,n)},symlink:function(e,t){if(!xe.resolve(e))throw new Be.ErrnoError(2);var n=Be.lookupPath(t,{parent:!0}),r=n.node;if(!r)throw new Be.ErrnoError(2);var o=Pe.basename(t),a=Be.mayCreate(r,o);if(a)throw new Be.ErrnoError(a);if(!r.node_ops.symlink)throw new Be.ErrnoError(1);return r.node_ops.symlink(r,o,e)},rename:function(t,n){var r,o,a,s=Pe.dirname(t),i=Pe.dirname(n),d=Pe.basename(t),l=Pe.basename(n);try{r=Be.lookupPath(t,{parent:!0}),o=r.node,r=Be.lookupPath(n,{parent:!0}),a=r.node}catch(t){throw new Be.ErrnoError(16)}if(!o||!a)throw new Be.ErrnoError(2);if(o.mount!==a.mount)throw new Be.ErrnoError(18);var p=Be.lookupNode(o,d),u=xe.relative(t,i);if("."!==u.charAt(0))throw new Be.ErrnoError(22);if(u=xe.relative(n,s),"."!==u.charAt(0))throw new Be.ErrnoError(39);var m;try{m=Be.lookupNode(a,l)}catch(t){}if(p!==m){var _=Be.isDir(p.mode),c=Be.mayDelete(o,d,_);if(c)throw new Be.ErrnoError(c);if(c=m?Be.mayDelete(a,l,_):Be.mayCreate(a,l),c)throw new Be.ErrnoError(c);if(!o.node_ops.rename)throw new Be.ErrnoError(1);if(Be.isMountpoint(p)||m&&Be.isMountpoint(m))throw new Be.ErrnoError(16);if(a!==o&&(c=Be.nodePermissions(o,"w"),c))throw new Be.ErrnoError(c);try{Be.trackingDelegate.willMovePath&&Be.trackingDelegate.willMovePath(t,n)}catch(r){console.log("FS.trackingDelegate['willMovePath']('"+t+"', '"+n+"') threw an exception: "+r.message)}Be.hashRemoveNode(p);try{o.node_ops.rename(p,a,l)}catch(t){throw t}finally{Be.hashAddNode(p)}try{Be.trackingDelegate.onMovePath&&Be.trackingDelegate.onMovePath(t,n)}catch(r){console.log("FS.trackingDelegate['onMovePath']('"+t+"', '"+n+"') threw an exception: "+r.message)}}},rmdir:function(t){var n=Be.lookupPath(t,{parent:!0}),r=n.node,o=Pe.basename(t),a=Be.lookupNode(r,o),s=Be.mayDelete(r,o,!0);if(s)throw new Be.ErrnoError(s);if(!r.node_ops.rmdir)throw new Be.ErrnoError(1);if(Be.isMountpoint(a))throw new Be.ErrnoError(16);try{Be.trackingDelegate.willDeletePath&&Be.trackingDelegate.willDeletePath(t)}catch(n){console.log("FS.trackingDelegate['willDeletePath']('"+t+"') threw an exception: "+n.message)}r.node_ops.rmdir(r,o),Be.destroyNode(a);try{Be.trackingDelegate.onDeletePath&&Be.trackingDelegate.onDeletePath(t)}catch(n){console.log("FS.trackingDelegate['onDeletePath']('"+t+"') threw an exception: "+n.message)}},readdir:function(e){var t=Be.lookupPath(e,{follow:!0}),n=t.node;if(!n.node_ops.readdir)throw new Be.ErrnoError(20);return n.node_ops.readdir(n)},unlink:function(t){var n=Be.lookupPath(t,{parent:!0}),r=n.node,o=Pe.basename(t),a=Be.lookupNode(r,o),s=Be.mayDelete(r,o,!1);if(s)throw new Be.ErrnoError(s);if(!r.node_ops.unlink)throw new Be.ErrnoError(1);if(Be.isMountpoint(a))throw new Be.ErrnoError(16);try{Be.trackingDelegate.willDeletePath&&Be.trackingDelegate.willDeletePath(t)}catch(n){console.log("FS.trackingDelegate['willDeletePath']('"+t+"') threw an exception: "+n.message)}r.node_ops.unlink(r,o),Be.destroyNode(a);try{Be.trackingDelegate.onDeletePath&&Be.trackingDelegate.onDeletePath(t)}catch(n){console.log("FS.trackingDelegate['onDeletePath']('"+t+"') threw an exception: "+n.message)}},readlink:function(e){var t=Be.lookupPath(e),n=t.node;if(!n)throw new Be.ErrnoError(2);if(!n.node_ops.readlink)throw new Be.ErrnoError(22);return xe.resolve(Be.getPath(n.parent),n.node_ops.readlink(n))},stat:function(e,t){var n=Be.lookupPath(e,{follow:!t}),r=n.node;if(!r)throw new Be.ErrnoError(2);if(!r.node_ops.getattr)throw new Be.ErrnoError(1);return r.node_ops.getattr(r)},lstat:function(e){return Be.stat(e,!0)},chmod:function(e,t,n){var r;if("string"==typeof e){var o=Be.lookupPath(e,{follow:!n});r=o.node}else r=e;if(!r.node_ops.setattr)throw new Be.ErrnoError(1);r.node_ops.setattr(r,{mode:4095&t|-4096&r.mode,timestamp:Date.now()})},lchmod:function(e,t){Be.chmod(e,t,!0)},fchmod:function(e,t){var n=Be.getStream(e);if(!n)throw new Be.ErrnoError(9);Be.chmod(n.node,t)},chown:function(e,t,n,r){var o;if("string"==typeof e){var a=Be.lookupPath(e,{follow:!r});o=a.node}else o=e;if(!o.node_ops.setattr)throw new Be.ErrnoError(1);o.node_ops.setattr(o,{timestamp:Date.now()})},lchown:function(e,t,n){Be.chown(e,t,n,!0)},fchown:function(e,t,n){var r=Be.getStream(e);if(!r)throw new Be.ErrnoError(9);Be.chown(r.node,t,n)},truncate:function(e,t){if(0>t)throw new Be.ErrnoError(22);var n;if("string"==typeof e){var r=Be.lookupPath(e,{follow:!0});n=r.node}else n=e;if(!n.node_ops.setattr)throw new Be.ErrnoError(1);if(Be.isDir(n.mode))throw new Be.ErrnoError(21);if(!Be.isFile(n.mode))throw new Be.ErrnoError(22);var o=Be.nodePermissions(n,"w");if(o)throw new Be.ErrnoError(o);n.node_ops.setattr(n,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var n=Be.getStream(e);if(!n)throw new Be.ErrnoError(9);if(0==(2097155&n.flags))throw new Be.ErrnoError(22);Be.truncate(n.node,t)},utime:function(e,t,n){var r=Be.lookupPath(e,{follow:!0}),o=r.node;o.node_ops.setattr(o,{timestamp:W(t,n)})},open:function(t,n,r,o,a){if(""===t)throw new Be.ErrnoError(2);n="string"==typeof n?Be.modeStringToFlags(n):n,r="undefined"==typeof r?438:r,r=64&n?32768|4095&r:0;var s;if("object"==typeof t)s=t;else{t=Pe.normalize(t);try{var i=Be.lookupPath(t,{follow:!(131072&n)});s=i.node}catch(t){}}var d=!1;if(64&n)if(!s)s=Be.mknod(t,r,0),d=!0;else if(128&n)throw new Be.ErrnoError(17);if(!s)throw new Be.ErrnoError(2);if(Be.isChrdev(s.mode)&&(n&=-513),65536&n&&!Be.isDir(s.mode))throw new Be.ErrnoError(20);if(!d){var l=Be.mayOpen(s,n);if(l)throw new Be.ErrnoError(l)}512&n&&Be.truncate(s,0),n&=-641;var p=Be.createStream({node:s,path:Be.getPath(s),flags:n,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1},o,a);p.stream_ops.open&&p.stream_ops.open(p),G.logReadFiles&&!(1&n)&&(!Be.readFiles&&(Be.readFiles={}),!(t in Be.readFiles)&&(Be.readFiles[t]=1,console.log("FS.trackingDelegate error on read file: "+t)));try{if(Be.trackingDelegate.onOpenFile){var u=0;1!=(2097155&n)&&(u|=Be.tracking.openFlags.READ),0!=(2097155&n)&&(u|=Be.tracking.openFlags.WRITE),Be.trackingDelegate.onOpenFile(t,u)}}catch(n){console.log("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+n.message)}return p},close:function(e){if(Be.isClosed(e))throw new Be.ErrnoError(9);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{Be.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,n){if(Be.isClosed(e))throw new Be.ErrnoError(9);if(!e.seekable||!e.stream_ops.llseek)throw new Be.ErrnoError(29);if(0!=n&&1!=n&&2!=n)throw new Be.ErrnoError(22);return e.position=e.stream_ops.llseek(e,t,n),e.ungotten=[],e.position},read:function(e,t,n,r,o){if(0>r||0>o)throw new Be.ErrnoError(22);if(Be.isClosed(e))throw new Be.ErrnoError(9);if(1==(2097155&e.flags))throw new Be.ErrnoError(9);if(Be.isDir(e.node.mode))throw new Be.ErrnoError(21);if(!e.stream_ops.read)throw new Be.ErrnoError(22);var a="undefined"!=typeof o;if(!a)o=e.position;else if(!e.seekable)throw new Be.ErrnoError(29);var s=e.stream_ops.read(e,t,n,r,o);return a||(e.position+=s),s},write:function(t,n,r,o,a,s){if(0>o||0>a)throw new Be.ErrnoError(22);if(Be.isClosed(t))throw new Be.ErrnoError(9);if(0==(2097155&t.flags))throw new Be.ErrnoError(9);if(Be.isDir(t.node.mode))throw new Be.ErrnoError(21);if(!t.stream_ops.write)throw new Be.ErrnoError(22);1024&t.flags&&Be.llseek(t,0,2);var i="undefined"!=typeof a;if(!i)a=t.position;else if(!t.seekable)throw new Be.ErrnoError(29);var d=t.stream_ops.write(t,n,r,o,a,s);i||(t.position+=d);try{t.path&&Be.trackingDelegate.onWriteToFile&&Be.trackingDelegate.onWriteToFile(t.path)}catch(n){console.log("FS.trackingDelegate['onWriteToFile']('"+t.path+"') threw an exception: "+n.message)}return d},allocate:function(e,t,n){if(Be.isClosed(e))throw new Be.ErrnoError(9);if(0>t||0>=n)throw new Be.ErrnoError(22);if(0==(2097155&e.flags))throw new Be.ErrnoError(9);if(!Be.isFile(e.node.mode)&&!Be.isDir(e.node.mode))throw new Be.ErrnoError(19);if(!e.stream_ops.allocate)throw new Be.ErrnoError(95);e.stream_ops.allocate(e,t,n)},mmap:function(e,t,n,r,o,a,s){if(0!=(2&a)&&0==(2&s)&&2!=(2097155&e.flags))throw new Be.ErrnoError(13);if(1==(2097155&e.flags))throw new Be.ErrnoError(13);if(!e.stream_ops.mmap)throw new Be.ErrnoError(19);return e.stream_ops.mmap(e,t,n,r,o,a,s)},msync:function(e,t,n,r,o){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,n,r,o):0},munmap:function(){return 0},ioctl:function(e,t,n){if(!e.stream_ops.ioctl)throw new Be.ErrnoError(25);return e.stream_ops.ioctl(e,t,n)},readFile:function(e,t){if(t=t||{},t.flags=t.flags||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error("Invalid encoding type \""+t.encoding+"\"");var n,r=Be.open(e,t.flags),o=Be.stat(e),s=o.size,i=new Uint8Array(s);return Be.read(r,i,0,s,0),"utf8"===t.encoding?n=a(i,0):"binary"===t.encoding&&(n=i),Be.close(r),n},writeFile:function(e,t,n){n=n||{},n.flags=n.flags||"w";var r=Be.open(e,n.flags,n.mode);if("string"==typeof t){var o=new Uint8Array(l(t)+1),a=i(t,o,0,o.length);Be.write(r,o,0,a,void 0,n.canOwn)}else if(ArrayBuffer.isView(t))Be.write(r,t,0,t.byteLength,void 0,n.canOwn);else throw new Error("Unsupported data type");Be.close(r)},cwd:function(){return Be.currentPath},chdir:function(e){var t=Be.lookupPath(e,{follow:!0});if(null===t.node)throw new Be.ErrnoError(2);if(!Be.isDir(t.node.mode))throw new Be.ErrnoError(20);var n=Be.nodePermissions(t.node,"x");if(n)throw new Be.ErrnoError(n);Be.currentPath=t.path},createDefaultDirectories:function(){Be.mkdir("/tmp"),Be.mkdir("/home"),Be.mkdir("/home/web_user")},createDefaultDevices:function(){Be.mkdir("/dev"),Be.registerDevice(Be.makedev(1,3),{read:function(){return 0},write:function(e,t,n,r){return r}}),Be.mkdev("/dev/null",Be.makedev(1,3)),Ae.register(Be.makedev(5,0),Ae.default_tty_ops),Ae.register(Be.makedev(6,0),Ae.default_tty1_ops),Be.mkdev("/dev/tty",Be.makedev(5,0)),Be.mkdev("/dev/tty1",Be.makedev(6,0));var e;if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}else;e||(e=function(){j("random_device")}),Be.createDevice("/dev","random",e),Be.createDevice("/dev","urandom",e),Be.mkdir("/dev/shm"),Be.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){Be.mkdir("/proc"),Be.mkdir("/proc/self"),Be.mkdir("/proc/self/fd"),Be.mount({mount:function(){var e=Be.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var n=Be.getStream(+t);if(!n)throw new Be.ErrnoError(9);var r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return r.parent=r,r}},e}},{},"/proc/self/fd")},createStandardStreams:function(){G.stdin?Be.createDevice("/dev","stdin",G.stdin):Be.symlink("/dev/tty","/dev/stdin"),G.stdout?Be.createDevice("/dev","stdout",null,G.stdout):Be.symlink("/dev/tty","/dev/stdout"),G.stderr?Be.createDevice("/dev","stderr",null,G.stderr):Be.symlink("/dev/tty1","/dev/stderr");var e=Be.open("/dev/stdin","r"),t=Be.open("/dev/stdout","w"),n=Be.open("/dev/stderr","w")},ensureErrnoError:function(){Be.ErrnoError||(Be.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error",this.stack&&Object.defineProperty(this,"stack",{value:new Error().stack,writable:!0})},Be.ErrnoError.prototype=new Error,Be.ErrnoError.prototype.constructor=Be.ErrnoError,[2].forEach(function(e){Be.genericErrors[e]=new Be.ErrnoError(e),Be.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:function(){Be.ensureErrnoError(),Be.nameTable=Array(4096),Be.mount(Le,{},"/"),Be.createDefaultDirectories(),Be.createDefaultDevices(),Be.createSpecialDirectories(),Be.filesystems={MEMFS:Le}},init:function(e,t,n){Be.init.initialized=!0,Be.ensureErrnoError(),G.stdin=e||G.stdin,G.stdout=t||G.stdout,G.stderr=n||G.stderr,Be.createStandardStreams()},quit:function(){Be.init.initialized=!1;var e=G._fflush;e&&e(0);for(var t,n=0;n<Be.streams.length;n++)(t=Be.streams[n],!!t)&&Be.close(t)},getMode:function(e,t){var n=0;return e&&(n|=365),t&&(n|=146),n},joinPath:function(e,t){var n=Pe.join.apply(null,e);return t&&"/"==n[0]&&(n=n.substr(1)),n},absolutePath:function(e,t){return xe.resolve(t,e)},standardizePath:function(e){return Pe.normalize(e)},findObject:function(e,t){var n=Be.analyzePath(e,t);return n.exists?n.object:(x(n.error),null)},analyzePath:function(e,t){try{var n=Be.lookupPath(e,{follow:!t});e=n.path}catch(t){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=Be.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=n.path,r.parentObject=n.node,r.name=Pe.basename(e),n=Be.lookupPath(e,{follow:!t}),r.exists=!0,r.path=n.path,r.object=n.node,r.name=n.node.name,r.isRoot="/"===n.path}catch(t){r.error=t.errno}return r},createFolder:function(e,t,n,r){var o=Pe.join2("string"==typeof e?e:Be.getPath(e),t),a=Be.getMode(n,r);return Be.mkdir(o,a)},createPath:function(e,t){e="string"==typeof e?e:Be.getPath(e);for(var n,r=t.split("/").reverse();r.length;)if(n=r.pop(),n){var o=Pe.join2(e,n);try{Be.mkdir(o)}catch(t){}e=o}return o},createFile:function(e,t,n,r,o){var a=Pe.join2("string"==typeof e?e:Be.getPath(e),t),s=Be.getMode(r,o);return Be.create(a,s)},createDataFile:function(e,t,n,r,o,a){var s=t?Pe.join2("string"==typeof e?e:Be.getPath(e),t):e,d=Be.getMode(r,o),l=Be.create(s,d);if(n){if("string"==typeof n){for(var p=Array(n.length),u=0,m=n.length;u<m;++u)p[u]=n.charCodeAt(u);n=p}Be.chmod(l,146|d);var _=Be.open(l,"w");Be.write(_,n,0,n.length,0,a),Be.close(_),Be.chmod(l,d)}return l},createDevice:function(e,t,n,r){var o=Pe.join2("string"==typeof e?e:Be.getPath(e),t),a=Be.getMode(!!n,!!r);Be.createDevice.major||(Be.createDevice.major=64);var s=Be.makedev(Be.createDevice.major++,0);return Be.registerDevice(s,{open:function(e){e.seekable=!1},close:function(){r&&r.buffer&&r.buffer.length&&r(10)},read:function(e,t,r,o){for(var a=0,s=0;s<o;s++){var d;try{d=n()}catch(t){throw new Be.ErrnoError(5)}if(void 0===d&&0===a)throw new Be.ErrnoError(11);if(null===d||void 0===d)break;a++,t[r+s]=d}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,n,o){for(var a=0;a<o;a++)try{r(t[n+a])}catch(t){throw new Be.ErrnoError(5)}return o&&(e.node.timestamp=Date.now()),a}}),Be.mkdev(o,a,s)},createLink:function(e,t,n){var r=Pe.join2("string"==typeof e?e:Be.getPath(e),t);return Be.symlink(n,r)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else if(G.read)try{e.contents=N(G.read(e.url),!0),e.usedBytes=e.contents.length}catch(n){t=!1}else throw new Error("Cannot load without read() or XMLHttpRequest.");return t||x(5),t},createLazyFile:function(e,t,n,r,o){function a(){this.lengthKnown=!1,this.chunks=[]}if(a.prototype.get=function(e){if(!(e>this.length-1||0>e)){var t=e%this.chunkSize,n=0|e/this.chunkSize;return this.getter(n)[t]}},a.prototype.setDataGetter=function(e){this.getter=e},a.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",n,!1),e.send(null),!(200<=e.status&&300>e.status||304===e.status))throw new Error("Couldn't load "+n+". Status: "+e.status);var t,r=+e.getResponseHeader("Content-length"),o=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,a=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;o||(s=r);var i=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>r-1)throw new Error("only "+r+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",n,!1),r!==s&&o.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(o.responseType="arraybuffer"),o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(200<=o.status&&300>o.status||304===o.status))throw new Error("Couldn't load "+n+". Status: "+o.status);return void 0===o.response?N(o.responseText||"",!0):new Uint8Array(o.response||[])},d=this;d.setDataGetter(function(e){var t=e*s,n=(e+1)*s-1;if(n=U(n,r-1),"undefined"==typeof d.chunks[e]&&(d.chunks[e]=i(t,n)),"undefined"==typeof d.chunks[e])throw new Error("doXHR failed!");return d.chunks[e]}),(a||!r)&&(s=r=1,r=this.getter(0).length,s=r,console.log("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=r,this._chunkSize=s,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest){if(!V)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new a;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var i={isDevice:!1,contents:s}}else var i={isDevice:!1,url:n};var d=Be.createFile(e,t,i,r,o);i.contents?d.contents=i.contents:i.url&&(d.contents=null,d.url=i.url),Object.defineProperties(d,{usedBytes:{get:function(){return this.contents.length}}});var l={},p=Object.keys(d.stream_ops);return p.forEach(function(e){var t=d.stream_ops[e];l[e]=function(){if(!Be.forceLoadFile(d))throw new Be.ErrnoError(5);return t.apply(null,arguments)}}),l.read=function(e,t,n,r,o){if(!Be.forceLoadFile(d))throw new Be.ErrnoError(5);var a=e.node.contents;if(o>=a.length)return 0;var s=U(a.length-o,r);if(a.slice)for(var l=0;l<s;l++)t[n+l]=a[o+l];else for(var l=0;l<s;l++)t[n+l]=a.get(o+l);return s},d.stream_ops=l,d},createPreloadedFile:function(e,t,n,r,o,a,s,i,d,l){function p(n){function p(n){l&&l(),i||Be.createDataFile(e,t,n,r,o,d),a&&a(),D(m)}var _=!1;G.preloadPlugins.forEach(function(e){_||e.canHandle(u)&&(e.handle(n,u,p,function(){s&&s(),D(m)}),_=!0)}),_||p(n)}Browser.init();var u=t?xe.resolve(Pe.join2(e,t)):e,m=v("cp "+u);F(m),"string"==typeof n?Browser.asyncLoad(n,function(e){p(e)},s):p(n)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,n){t=t||function(){},n=n||function(){};var r=Be.indexedDB();try{var o=r.open(Be.DB_NAME(),Be.DB_VERSION)}catch(t){return n(t)}o.onupgradeneeded=function(){console.log("creating db");var e=o.result;e.createObjectStore(Be.DB_STORE_NAME)},o.onsuccess=function(){function r(){0==l?t():n()}var a=o.result,s=a.transaction([Be.DB_STORE_NAME],"readwrite"),i=s.objectStore(Be.DB_STORE_NAME),d=0,l=0,p=e.length;e.forEach(function(e){var t=i.put(Be.analyzePath(e).object.contents,e);t.onsuccess=function(){d++,d+l==p&&r()},t.onerror=function(){l++,d+l==p&&r()}}),s.onerror=n},o.onerror=n},loadFilesFromDB:function(e,t,n){t=t||function(){},n=n||function(){};var r=Be.indexedDB();try{var o=r.open(Be.DB_NAME(),Be.DB_VERSION)}catch(t){return n(t)}o.onupgradeneeded=n,o.onsuccess=function(){function r(){0==l?t():n()}var a=o.result;try{var s=a.transaction([Be.DB_STORE_NAME],"readonly")}catch(t){return void n(t)}var i=s.objectStore(Be.DB_STORE_NAME),d=0,l=0,p=e.length;e.forEach(function(e){var t=i.get(e);t.onsuccess=function(){Be.analyzePath(e).exists&&Be.unlink(e),Be.createDataFile(Pe.dirname(e),Pe.basename(e),t.result,!0,!0,!0),d++,d+l==p&&r()},t.onerror=function(){l++,d+l==p&&r()}}),s.onerror=n},o.onerror=n}},Re={DEFAULT_POLLMASK:5,mappings:{},umask:511,calculateAt:function(e,t){if("/"!==t[0]){var n;if(-100===e)n=Be.cwd();else{var r=Be.getStream(e);if(!r)throw new Be.ErrnoError(9);n=r.path}t=Pe.join2(n,t)}return t},doStat:function(e,t,n){try{var r=e(t)}catch(n){if(n&&n.node&&Pe.normalize(t)!==Pe.normalize(Be.getPath(n.node)))return-20;throw n}return ae[n>>2]=r.dev,ae[n+4>>2]=0,ae[n+8>>2]=r.ino,ae[n+12>>2]=r.mode,ae[n+16>>2]=r.nlink,ae[n+20>>2]=r.uid,ae[n+24>>2]=r.gid,ae[n+28>>2]=r.rdev,ae[n+32>>2]=0,tempI64=[r.size>>>0,(tempDouble=r.size,1<=+ke(tempDouble)?0<tempDouble?(0|Fe(+ve(tempDouble/4294967296),4294967295))>>>0:~~+Ce((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],ae[n+40>>2]=tempI64[0],ae[n+44>>2]=tempI64[1],ae[n+48>>2]=4096,ae[n+52>>2]=r.blocks,ae[n+56>>2]=0|r.atime.getTime()/1e3,ae[n+60>>2]=0,ae[n+64>>2]=0|r.mtime.getTime()/1e3,ae[n+68>>2]=0,ae[n+72>>2]=0|r.ctime.getTime()/1e3,ae[n+76>>2]=0,tempI64=[r.ino>>>0,(tempDouble=r.ino,1<=+ke(tempDouble)?0<tempDouble?(0|Fe(+ve(tempDouble/4294967296),4294967295))>>>0:~~+Ce((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],ae[n+80>>2]=tempI64[0],ae[n+84>>2]=tempI64[1],0},doMsync:function(e,t,n,r){var o=new Uint8Array(ne.subarray(e,e+n));Be.msync(t,o,0,n,r)},doMkdir:function(e,t){return e=Pe.normalize(e),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),Be.mkdir(e,t,0),0},doMknod:function(e,t,n){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-22;}return Be.mknod(e,t,n),0},doReadlink:function(e,t,n){if(0>=n)return-22;var r=Be.readlink(e),o=U(n,l(r)),a=te[t+o];return d(r,t,n+1),te[t+o]=a,o},doAccess:function(e,t){if(-8&t)return-22;var n,r=Be.lookupPath(e,{follow:!0});n=r.node;var o="";return 4&t&&(o+="r"),2&t&&(o+="w"),1&t&&(o+="x"),o&&Be.nodePermissions(n,o)?-13:0},doDup:function(e,t,n){var r=Be.getStream(n);return r&&Be.close(r),Be.open(e,t,0,n,n).fd},doReadv:function(e,t,n,r){for(var o=0,a=0;a<n;a++){var s=ae[t+8*a>>2],d=ae[t+(8*a+4)>>2],l=Be.read(e,te,s,d,r);if(0>l)return-1;if(o+=l,l<d)break}return o},doWritev:function(e,t,n,r){for(var o=0,a=0;a<n;a++){var s=ae[t+8*a>>2],d=ae[t+(8*a+4)>>2],l=Be.write(e,te,s,d,r);if(0>l)return-1;o+=l}return o},varargs:0,get:function(){Re.varargs+=4;var e=ae[Re.varargs-4>>2];return e},getStr:function(){var e=s(Re.get());return e},getStreamFromFD:function(){var e=Be.getStream(Re.get());if(!e)throw new Be.ErrnoError(9);return e},get64:function(){var e=Re.get(),t=Re.get();return e},getZero:function(){Re.get()}};Be.staticInit();var Me=G.asm({},{b:j,p:function(){},h:x,k:A,j:function(e,t){Re.varargs=t;try{var n=Re.getStreamFromFD(),r=Re.get(),o=Re.get();return Re.doReadv(n,r,o)}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}},g:function(e,t){Re.varargs=t;try{var n=Re.getStreamFromFD(),r=Re.get(),o=Re.get();return Re.doWritev(n,r,o)}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}},c:L,i:function(e,t){Re.varargs=t;try{var n=Re.getStr(),r=Re.get(),o=Re.get(),a=Be.open(n,r,o);return a.fd}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}},f:B,e:function(e,t){Re.varargs=t;try{var n=Re.getStreamFromFD();return Be.close(n),0}catch(t){return"undefined"!=typeof Be&&t instanceof Be.ErrnoError||j(t),-t.errno}},d:function(){},o:R,n:M,m:function(e){var t=R(),n=65536,r=2147483648-n;if(e>r)return!1;for(var o=W(t,16777216);o<e;)o=536870912>=o?c(2*o,n):U(c((3*o+2147483648)/4,n),r);return!!O(o)&&(g(),!0)},l:function(){j("OOM")},a:_e},ee);G.asm=Me;var Oe=G.___errno_location=function(){return G.asm.q.apply(null,arguments)},Ne=G._free=function(){return G.asm.r.apply(null,arguments)},ze=G._malloc=function(){return G.asm.s.apply(null,arguments)},Ie=G._mid_alloc_options=function(){return G.asm.t.apply(null,arguments)},je=G._mid_exit=function(){return G.asm.u.apply(null,arguments)},He=G._mid_get_load_request=function(){return G.asm.v.apply(null,arguments)},Ue=G._mid_get_load_request_count=function(){return G.asm.w.apply(null,arguments)},We=G._mid_init=function(){return G.asm.x.apply(null,arguments)},qe=G._mid_istream_close=function(){return G.asm.y.apply(null,arguments)},Ge=G._mid_istream_open_mem=function(){return G.asm.z.apply(null,arguments)},Ke=G._mid_song_free=function(){return G.asm.A.apply(null,arguments)},Ve=G._mid_song_get_time=function(){return G.asm.B.apply(null,arguments)},Xe=G._mid_song_get_total_time=function(){return G.asm.C.apply(null,arguments)},Ye=G._mid_song_load=function(){return G.asm.D.apply(null,arguments)},$e=G._mid_song_read_wave=function(){return G.asm.E.apply(null,arguments)},Je=G._mid_song_seek=function(){return G.asm.F.apply(null,arguments)},Ze=G._mid_song_start=function(){return G.asm.G.apply(null,arguments)},Qe=G.stackAlloc=function(){return G.asm.H.apply(null,arguments)};if(G.asm=Me,G.UTF8ToString=s,G.FS=Be,G.then=function(e){if(G.calledRun)e(G);else{var t=G.onRuntimeInitialized;G.onRuntimeInitialized=function(){t&&t(),e(G)}}return G},z.prototype=new Error,z.prototype.constructor=z,Se=function e(){G.calledRun||I(),G.calledRun||(Se=e)},G.run=I,G.abort=j,G.preInit)for("function"==typeof G.preInit&&(G.preInit=[G.preInit]);0<G.preInit.length;)G.preInit.pop()();return G.noExitRuntime=!0,I(),r}}();"object"==typeof a&&"object"==typeof o?o.exports=s:"function"==typeof n&&n.amd?n([],function(){return s}):"object"==typeof a&&(a.LibTimidity=s)},{}],9:[function(e,t,r){(function(e,o){"object"==typeof r&&"undefined"!=typeof t?t.exports=o():"function"==typeof n&&n.amd?n(o):e.whenDomReady=o()})(this,function(){'use strict';var e=["interactive","complete"],t=function(t,n){return new Promise(function(r){t&&"function"!=typeof t&&(n=t,t=null),n=n||window.document;var o=function(){return r(void(t&&setTimeout(t)))};-1===e.indexOf(n.readyState)?n.addEventListener("DOMContentLoaded",o):o()})};return t.resume=function(e){return function(n){return t(e).then(function(){return n})}},t})},{}],"/":[function(e,t){const n=e("debug")("bg-sound"),r=e("timidity"),o=e("insert-css"),a=e("when-dom-ready");class s extends HTMLElement{static get observedAttributes(){return["src","baseUrl","loop"]}constructor(){super(),this._playingFired=!1,this._onClick=this._onClick.bind(this),this._onPlaying=this._onPlaying.bind(this),this._onEnded=this._onEnded.bind(this)}connectedCallback(){document.addEventListener("click",this._onClick),this.hasAttribute("baseUrl")||this.setAttribute("baseUrl","https://bitmidi.com/timidity/"),this.hasAttribute("loop")||this.setAttribute("loop",0),this.playCount=0,this._initPlayer()}disconnectedCallback(){document.removeEventListener("click",this._onClick),this._destroyPlayer()}get src(){return this.getAttribute("src")}set src(e){this.setAttribute("src",e)}get loop(){return this.getAttribute("loop")}set loop(e){this.setAttribute("loop",e)}get baseUrl(){return this.getAttribute("baseUrl")}set baseUrl(e){this.setAttribute("baseUrl",e)}attributeChangedCallback(e,t,r){n(`${e} changed from ${t} to ${r}`),"src"===e,"baseUrl"===e}_initPlayer(){this.player=new r(this.baseUrl),this.player.once("playing",this._onPlaying),this.player.once("ended",this._onEnded),this.player.load(this.src),this.player.play()}_destroyPlayer(){this.player.pause(),this.player.destroy(),this.player.removeListener("playing",this._onPlaying),this.player.removeListener("ended",this._onEnded),this.player=null}_onPlaying(){this._playingFired=!0}_onEnded(){this._destroyPlayer(),this.playCount+=1;const e=(this.loop+"").toLowerCase();("infinite"===e||"true"===e||"-1"===e||+this.loop>this.playCount)&&this._initPlayer()}_onClick(){this._playingFired||this.player.play()}}window.customElements.define("bg-sound",s),t.exports=s,t.exports.enableCompatMode=function(e={}){o(`
    embed {
      display: none;
    }
  `),a().then(()=>{const t=[...document.querySelectorAll("embed"),...document.querySelectorAll("bgsound")];t.forEach(t=>{let n=t.getAttribute("src");const r=t.getAttribute("loop");if(t.remove(),n=new URL(n,window.location.href).href,console.log(n),!!n){if(n.endsWith(".mid")||n.endsWith(".midi")){const t=document.createElement("bg-sound");t.setAttribute("src",n),r&&t.setAttribute("loop",r),e.baseUrl&&t.setAttribute("baseUrl",e.baseUrl),document.body.appendChild(t)}if(n.endsWith(".wav")){const e=document.createElement("audio");e.src=n,e.controls=!1,e.autoplay=!0,r&&("infinite"===r.toLowerCase()||"true"===r||"-1"===r||2<=+r)&&(e.loop=!0);let t=!1;e.addEventListener("playing",()=>{t=!0}),document.body.addEventListener("click",()=>{t||e.play()}),document.body.appendChild(e)}}})})}},{debug:1,"insert-css":4,timidity:7,"when-dom-ready":9}]},{},[])("/")});